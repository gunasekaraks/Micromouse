#include <Arduino.h>
#include <Wire.h>
#include "vl53l0x_v2.h"

VL53L0XV2 tofSensor(17);  // XSHUT pin 17

void setup() {
    Serial.begin(115200);
    delay(1000);
    
    Serial.println("\n=== ToF Sensor Test ===\n");
    
    // Initialize I2C
    Wire.begin();
    Serial.println("I2C initialized");
    delay(500);
    
    // Initialize ToF sensor (begin() handles XSHUT internally)
    Serial.println("Initializing ToF sensor...");
    if (!tofSensor.begin()) {
        Serial.println("ERROR: ToF sensor initialization failed!");
        Serial.println("Check:");
        Serial.println("- XSHUT connected to pin 17");
        Serial.println("- SDA/SCL connections");
        Serial.println("- VL53L0X I2C address (0x29)");
        while(1) { delay(1000); }
    }
    
    Serial.println("ToF sensor initialized successfully!");
    Serial.println("Reading distance every 200ms...\n");
    delay(500);
}

void loop() {
    uint16_t distance = tofSensor.getDistance();
    
    Serial.print("Distance: ");
    Serial.print(distance);
    Serial.print(" mm (");
    Serial.print(distance / 10.0, 1);
    Serial.println(" cm)");
    
    delay(200);
}
